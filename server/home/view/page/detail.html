<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Bloggy - Personal Blog Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free Website Template" name="keywords">
    <meta content="Free Website Template" name="description">


    <link href="https://fonts.googleapis.com/css2?family=Open%20Sans:300;400;600;700;800&display=swap" rel="stylesheet">

    <link href="/static/css/all.min.css" rel="stylesheet">

    <link href="/static/css/style.css" rel="stylesheet">

    <style>
        *{ margin:0; padding:0; list-style:none;}
        a{ text-decoration:none;}
        a:hover{ text-decoration:none;}
        .tcdPageCode{padding: 15px 20px;text-align: left;color: #ccc;text-align:center;}
        .tcdPageCode a{display: inline-block;color: #428bca;display: inline-block;height: 25px;	line-height: 25px;	padding: 0 10px;border: 1px solid #ddd;	margin: 0 2px;border-radius: 4px;vertical-align: middle;}
        .tcdPageCode a:hover{text-decoration: none;border: 1px solid #428bca;}
        .tcdPageCode span.current{display: inline-block;height: 25px;line-height: 25px;padding: 0 10px;margin: 0 2px;color: #fff;background-color: #428bca;	border: 1px solid #428bca;border-radius: 4px;vertical-align: middle;}
        .tcdPageCode span.disabled{	display: inline-block;height: 25px;line-height: 25px;padding: 0 10px;margin: 0 2px;	color: #bfbfbf;background: #f2f2f2;border: 1px solid #bfbfbf;border-radius: 4px;vertical-align: middle;}
    </style>
</head>
<body>
<div class="wrapper">
    <div class="sidebar">
        <div class="sidebar-text d-flex flex-column h-100 justify-content-center text-center">
            <img class="mx-auto d-block w-75 bg-primary img-fluid rounded-circle mb-4 p-3"
                 src="/static/picture/profile.jpg" alt="Image">
            <h1 class="font-weight-bold">Kate Glover</h1>
            <p class="mb-4">
                Justo stet no accusam stet invidunt sanctus magna clita vero eirmod, sit sit labore dolores lorem. Lorem
                at sit dolor dolores sed diam justo
            </p>
            <div class="d-flex justify-content-center mb-5">
                <a class="btn btn-outline-primary mr-2" href="#"><i class="fab fa-twitter"></i></a>
                <a class="btn btn-outline-primary mr-2" href="#"><i class="fab fa-facebook-f"></i></a>
                <a class="btn btn-outline-primary mr-2" href="#"><i class="fab fa-linkedin-in"></i></a>
                <a class="btn btn-outline-primary mr-2" href="#"><i class="fab fa-instagram"></i></a>
            </div>
            <a href="/contact" class="btn btn-lg btn-block btn-primary mt-auto">Hire Me</a>
        </div>
        <div class="sidebar-icon d-flex flex-column h-100 justify-content-center text-right">
            <i class="fas fa-2x fa-angle-double-right text-primary"></i>
        </div>
    </div>
    <div class="content">

        <div class="container p-0">
            <nav class="navbar navbar-expand-lg bg-secondary navbar-dark">
                <a href="" class="navbar-brand d-block d-lg-none">Navigation</a>
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                    <div class="navbar-nav m-auto">
                        <a href="/index" class="nav-item nav-link">Home</a>
                        <a href="/about" class="nav-item nav-link">About</a>
                        <a href="/blog/1/4" class="nav-item nav-link" >Blog</a>
                        <a href="/contact" class="nav-item nav-link">Contact</a>
                    </div>
                </div>
            </nav>
        </div>


        <div class="container py-5 px-2 bg-primary">
            <div class="row py-5 px-4">
                <div class="col-sm-6 text-center text-md-left">
                    <h1 class="mb-3 mb-md-0 text-white text-uppercase font-weight-bold">Blog Detail</h1>
                </div>
                <div class="col-sm-6 text-center text-md-right">
                    <div class="d-inline-flex pt-2">
                        <h4 class="m-0 text-white"><a class="text-white" href="/index">Home</a></h4>
                        <h4 class="m-0 text-white px-2">/</h4>
                        <h4 class="m-0 text-white">Blog Detail</h4>
                    </div>
                </div>
            </div>
        </div>


        <div class="container py-5 px-2 bg-white">
            <div class="row px-4">
                <div class="col-12">
                    <img class="img-fluid mb-4" src="/{{ .info.Cover }}" alt="Image">
                    <h2 class="mb-3 font-weight-bold">{{ .info.Title }}</h2>
                    <div class="d-flex">
                        <p class="mr-3 text-muted"><i class="fa fa-calendar-alt"></i> {{ .info.CreatedAt | formatDate}}</p>
                        <p class="mr-3 text-muted"><i class="fa fa-folder"></i> {{.info.Browses}}</p>
                        <p class="mr-3 text-muted"><i class="fa fa-comments"></i> <span class="totalComment">{{ .info.Comments}}</span> Comments</p>
                    </div>
                    {{ .info.Content }}
                </div>
                <div class="col-12 py-4">
<!--                    <a href="" class="btn btn-sm btn-outline-primary mb-1">Lorem</a>-->
<!--                    <a href="" class="btn btn-sm btn-outline-primary mb-1">Lorem</a>-->
<!--                    <a href="" class="btn btn-sm btn-outline-primary mb-1">Lorem</a>-->
<!--                    <a href="" class="btn btn-sm btn-outline-primary mb-1">Lorem</a>-->
<!--                    <a href="" class="btn btn-sm btn-outline-primary mb-1">Lorem</a>-->
<!--                    <a href="" class="btn btn-sm btn-outline-primary mb-1">Lorem</a>-->
<!--                    <a href="" class="btn btn-sm btn-outline-primary mb-1">Lorem</a>-->
                </div>
                <div class="col-12 py-4">
                    <div class="btn-group btn-group-lg w-100">
                        <button type="button" class="btn btn-outline-primary" onclick="toPre()">
                            <i class="fa fa-angle-left mr-2"></i>
                            上一篇
                        </button>

                        <button type="button" class="btn btn-outline-primary" onclick="toNext()">下一篇<i class="fa fa-angle-right ml-2"></i>
                        </button>
                    </div>
                </div>
                <div class="col-12 py-4">
                    <h3 class="mb-4 font-weight-bold"><span class="totalComment">{{.totalComment}}</span> Comments</h3>
                    <div id="listComment">
                    {{range $k , $v :=.listComment}}
                    <div class="media mb-4">
                        <img src="/static/picture/user.jpg" alt="Image" class="mr-3 mt-1 rounded-circle"
                             style="width:60px;">
                        <div class="media-body">
                            <h4>{{$v.Name}} <small><i>{{$v.CreatedAt | formatDate}}</i></small></h4>
                            <p>{{$v.Message}}
                            </p>
                        </div>
                    </div>
                    {{end}}
                    </div>
                    <div class="tcdPageCode"></div>
                </div>
                <div class="col-12">
                    <h3 class="mb-4 font-weight-bold">Leave a comment(留下你的想法)</h3>
                    <form>
                        <div class="form-group">
                            <label for="name">Name *</label>
                            <input type="text" class="form-control" value="" id="name">
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone</label>
                            <input type="text" class="form-control" value="" id="phone">
                        </div>
                        <div class="form-group">
                            <label for="message">Message *</label>
                            <textarea id="message" cols="30" rows="5" class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <input type="button" value="Leave Comment" class="btn btn-primary" onclick="comment()">
                        </div>
                    </form>
                </div>
            </div>
        </div>


        <div class="container py-4 bg-secondary text-center">
            <p class="m-0 text-white">
                Copyright &copy; 2022.Company name All rights reserved.<a target="_blank"
                                                                          href=""></a>
            </p>
        </div>

    </div>
</div>

<a href="#" class="back-to-top"><i class="fa fa-angle-double-up"></i></a>

<script src="/static/js/jquery-3.4.1.min.js" type="bb787bcd2a1bc896f32ad8f1-text/javascript"></script>
<script src="/static/js/bootstrap.bundle.min.js" type="bb787bcd2a1bc896f32ad8f1-text/javascript"></script>
<script src="/static/js/easing.min.js" type="bb787bcd2a1bc896f32ad8f1-text/javascript"></script>
<script src="/static/js/waypoints.min.js" type="bb787bcd2a1bc896f32ad8f1-text/javascript"></script>

<script src="/static/js/jqBootstrapValidation.min.js" type="bb787bcd2a1bc896f32ad8f1-text/javascript"></script>
<script src="/static/js/contact.js" type="bb787bcd2a1bc896f32ad8f1-text/javascript"></script>

<script src="/static/js/main.js" type="bb787bcd2a1bc896f32ad8f1-text/javascript"></script>
<script src="/static/js/rocket-loader.min.js" data-cf-settings="bb787bcd2a1bc896f32ad8f1-|49" defer=""></script>

<script src="/static/js/jquery-1.8.3.min.js"></script>
<script src="/static/js/jquery.page.js"></script>

<script>
    var tcdPageCode = $(".tcdPageCode")
    let Id= {{ .info.ID }}
    let total = Number({{.totalComment}})
    let page = Number({{.page}})
    let pageSize = Number({{.pageSize}})
    let pageCount =Math.ceil(total/pageSize)
    let listCommentHtml = ''
    function toPre(){
        $.post("/home/toPre",JSON.stringify({id: Id}),function (data) {
            // console.log(data.data.id);
            $(location).attr('href', '/detail/'+data.data.id);
        })

    }
    function toNext(){
        $.post("/home/toNext",JSON.stringify({id: Id}),function (data) {
            $(location).attr('href', '/detail/'+data.data.id);
        })
    }
    function comment(){
        var data = {
            blog_id:Id,
            name:$("#name").val(),
            phone:$("#phone").val(),
            message:$("#message").val(),
        }
        $.post("/home/createComment",JSON.stringify(data),function (data) {
            if (data.code === 0) {
                listCommentHtml = ""
                $.each(data.data.list,function (index, item) {
                    listCommentHtml +='<div class="media mb-4">\n' +
                        '                        <img src="/static/picture/user.jpg" alt="Image" class="mr-3 mt-1 rounded-circle"\n' +
                        '                             style="width:60px;">\n' +
                        '                        <div class="media-body">\n' +
                        '                            <h4>'+item.name+'<small><i>'+formatDate(item.CreatedAt)+'</i></small></h4>\n' +
                        '                            <p>'+item.message+'\n' +
                        '                            </p>\n' +
                        '                        </div>\n' +
                        '                </div>'
                })
                $("#listComment").html(listCommentHtml)//列表
                $(".totalComment").html(data.data.total)//总数
                page = data.data.page
                total = data.data.total
                pageSize = data.data.pageSize
                pageCount =Math.ceil(total/pageSize)
                tcdPageCode.createPage({
                    pageCount:pageCount,
                    current:page,
                    backFn:function(p){}
                });
            }
        })
    }
    tcdPageCode.createPage({
        pageCount:pageCount,
        current:page,
        backFn:function(p){
            var data = {
                blog_id:Id,
                page:p,
                pageSize:pageSize,
            }
            $.post("/home/listComment",JSON.stringify(data),function (data) {
                if (data.code === 0) {
                    listCommentHtml = ""
                    $.each(data.data.list,function (index, item) {
                        listCommentHtml +='<div class="media mb-4">\n' +
                            '                        <img src="/static/picture/user.jpg" alt="Image" class="mr-3 mt-1 rounded-circle"\n' +
                            '                             style="width:60px;">\n' +
                            '                        <div class="media-body">\n' +
                            '                            <h4>'+item.name+'<small><i>'+formatDate(item.CreatedAt)+'</i></small></h4>\n' +
                            '                            <p>'+item.message+'\n' +
                            '                            </p>\n' +
                            '                        </div>\n' +
                            '                </div>'
                    })
                    $("#listComment").html(listCommentHtml)//列表
                }
            })
        }
    });

    formatDate = (time) => {
        if (time !== null && time !== '') {
            var date = new Date(time)
            return formatTimeToStr(date, 'yyyy-MM-dd hh:mm:ss')
        } else {
            return ''
        }
    }

    // 对Date的扩展，将 Date 转化为指定格式的String
    // 月(M)、日(d)、小时(h)、分(m)、秒(s)、季度(q) 可以用 1-2 个占位符，
    // 年(y)可以用 1-4 个占位符，毫秒(S)只能用 1 个占位符(是 1-3 位的数字)
    // (new Date()).Format("yyyy-MM-dd hh:mm:ss.S") ==> 2006-07-02 08:09:04.423
    // (new Date()).Format("yyyy-M-d h:m:s.S")      ==> 2006-7-2 8:9:4.18
    // eslint-disable-next-line no-extend-native
    Date.prototype.Format = function(fmt) {
        var o = {
            'M+': this.getMonth() + 1, // 月份
            'd+': this.getDate(), // 日
            'h+': this.getHours(), // 小时
            'm+': this.getMinutes(), // 分
            's+': this.getSeconds(), // 秒
            'q+': Math.floor((this.getMonth() + 3) / 3), // 季度
            'S': this.getMilliseconds() // 毫秒
        }
        if (/(y+)/.test(fmt)) { fmt = fmt.replace(RegExp.$1, (this.getFullYear() + '').substr(4 - RegExp.$1.length)) }
        for (var k in o) {
            if (new RegExp('(' + k + ')').test(fmt)) { fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : (('00' + o[k]).substr(('' + o[k]).length))) }
        }
        return fmt
    }

    function formatTimeToStr(times, pattern) {
        var d = new Date(times).Format('yyyy-MM-dd hh:mm:ss')
        if (pattern) {
            d = new Date(times).Format(pattern)
        }
        return d.toLocaleString()
    }
</script>
</body>
</html>
